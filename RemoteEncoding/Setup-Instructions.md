# Setup Instructions

## Tutorial

[IR Emitter Tutorial](https://learn.sparkfun.com/tutorials/ir-communication)

Required libraries are in resources > Arduino-IRremote-master.zip

To add them to your IDE perform same steps as described in setup-instructions for the RemoteDecoding

## Protocol

We're going to have to use the RemoteProtocol.ino program to get the infrared protocol of the bed. Common ones are, Sony, Matsushita, NEC, and RC5.

The protocol is how the infrared wave is convereted to binary, I am not 100% sure what kind of modulation is used, however, I am pretty sure data is encoded using FM (Frequency modulation). FM is just using 2 distinct frequencies to encode 0 and 1 (see below), AM is using 2 different amplitudes. 

The seperate protocols all use the same modulation technique and frequency bands, however, they use different time intervals between frequency changes.

![Difference Between AM And FM - Introduction | What is Amplitude Modulation](https://cdn1.byjus.com/wp-content/uploads/2020/07/Difference-Between-AM-And-FM1.png)

### Unknown protocol

If the remotes protocol comes up as unknown we can use **irsend.SendRaw(rawCode(s): int but[], codeLen: int, hz: int)**

### NEC Repeat Codes

The NEC protocol uses a special sequence of marks and spaces that mean "I held down the button so you should repeat whatever I sent you last time". It is up to you to decide do I want to allow repeat codes or do I want to force the operator to push and release the button each time. IRLib returns a value of 0xFFFFFFFF to tell you that the special repeat sequence was received. You can ignore that sequence which forces the user to release and repress the button each time or you can store the previously received code and process it whenever you see the special repeat message.

### Sony Triple Messages
The technical specification for Sony protocol says that you should send each code 3 consecutive times per keypress. IRLib takes care of sending three times for you so you don't need to do anything special. However when receiving Sony, be aware that you're going to get three copies of the data each time the user presses a button. If you're busy processing the first sequence you might miss the other two so it won't matter. But you need to be aware of it in case you're counting the number of keypresses or some other application.

### RC5 and RC6 Toggle Bits
The RC5 and RC6 protocols invented by Phillips use a special toggle bit to let you know whether a code was generated by holding down the button or whether this is an independent keypress. For example I have a TV which uses RC5 protocol and the code for Volume Up is 0x1010. If I press and hold that button it sends the same code repeatedly. However if I release the button and press it again I get 0x1810. Every other keypress the single bit 0x0800 will toggle off and on.  You can make sure that you ignore this feature by masking out that particular bit. When you receive a decoded value from this protocol you could do:

